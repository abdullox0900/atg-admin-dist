import{D as oa,j as l,E as ra,F as ia,J as G,K as i,l as f,M as C,r as x,N as ca,i as sa,O as na,Q as K,U as k,V as ta,u as da,a as B,B as H,C as pa,b as ua,S as R,T as y,c as ba,s as va,P as xa,v as ga,w as Ca,x as _,y as n,z as fa,W as P,q as T,G as A,H as $a}from"./index-DPVKpS60.js";import{u as ja}from"./notistack.esm-PkWn3jSX.js";import{D as ya,a as ha,b as ka}from"./DialogTitle-BGDm12jN.js";import"./useId-DrTdGP2W.js";const Ia=oa(l.jsx("path",{d:"M12 2C6.47 2 2 6.47 2 12s4.47 10 10 10 10-4.47 10-10S17.53 2 12 2zm5 13.59L15.59 17 12 13.41 8.41 17 7 15.59 10.59 12 7 8.41 8.41 7 12 10.59 15.59 7 17 8.41 13.41 12 17 15.59z"}),"Cancel");function ma(a){return ia("MuiChip",a)}const o=ra("MuiChip",["root","sizeSmall","sizeMedium","colorError","colorInfo","colorPrimary","colorSecondary","colorSuccess","colorWarning","disabled","clickable","clickableColorPrimary","clickableColorSecondary","deletable","deletableColorPrimary","deletableColorSecondary","outlined","filled","outlinedPrimary","outlinedSecondary","filledPrimary","filledSecondary","avatar","avatarSmall","avatarMedium","avatarColorPrimary","avatarColorSecondary","icon","iconSmall","iconMedium","iconColorPrimary","iconColorSecondary","label","labelSmall","labelMedium","deleteIcon","deleteIconSmall","deleteIconMedium","deleteIconColorPrimary","deleteIconColorSecondary","deleteIconOutlinedColorPrimary","deleteIconOutlinedColorSecondary","deleteIconFilledColorPrimary","deleteIconFilledColorSecondary","focusVisible"]),Da=["avatar","className","clickable","color","component","deleteIcon","disabled","icon","label","onClick","onDelete","onKeyDown","onKeyUp","size","variant","tabIndex","skipFocusWhenDisabled"],za=a=>{const{classes:e,disabled:p,size:c,color:s,iconColor:b,onDelete:v,clickable:t,variant:u}=a,$={root:["root",u,p&&"disabled",`size${i(c)}`,`color${i(s)}`,t&&"clickable",t&&`clickableColor${i(s)}`,v&&"deletable",v&&`deletableColor${i(s)}`,`${u}${i(s)}`],label:["label",`label${i(c)}`],avatar:["avatar",`avatar${i(c)}`,`avatarColor${i(s)}`],icon:["icon",`icon${i(c)}`,`iconColor${i(b)}`],deleteIcon:["deleteIcon",`deleteIcon${i(c)}`,`deleteIconColor${i(s)}`,`deleteIcon${i(u)}Color${i(s)}`]};return ta($,ma,e)},Oa=G("div",{name:"MuiChip",slot:"Root",overridesResolver:(a,e)=>{const{ownerState:p}=a,{color:c,iconColor:s,clickable:b,onDelete:v,size:t,variant:u}=p;return[{[`& .${o.avatar}`]:e.avatar},{[`& .${o.avatar}`]:e[`avatar${i(t)}`]},{[`& .${o.avatar}`]:e[`avatarColor${i(c)}`]},{[`& .${o.icon}`]:e.icon},{[`& .${o.icon}`]:e[`icon${i(t)}`]},{[`& .${o.icon}`]:e[`iconColor${i(s)}`]},{[`& .${o.deleteIcon}`]:e.deleteIcon},{[`& .${o.deleteIcon}`]:e[`deleteIcon${i(t)}`]},{[`& .${o.deleteIcon}`]:e[`deleteIconColor${i(c)}`]},{[`& .${o.deleteIcon}`]:e[`deleteIcon${i(u)}Color${i(c)}`]},e.root,e[`size${i(t)}`],e[`color${i(c)}`],b&&e.clickable,b&&c!=="default"&&e[`clickableColor${i(c)})`],v&&e.deletable,v&&c!=="default"&&e[`deletableColor${i(c)}`],e[u],e[`${u}${i(c)}`]]}})(({theme:a,ownerState:e})=>{const p=a.palette.mode==="light"?a.palette.grey[700]:a.palette.grey[300];return f({maxWidth:"100%",fontFamily:a.typography.fontFamily,fontSize:a.typography.pxToRem(13),display:"inline-flex",alignItems:"center",justifyContent:"center",height:32,color:(a.vars||a).palette.text.primary,backgroundColor:(a.vars||a).palette.action.selected,borderRadius:32/2,whiteSpace:"nowrap",transition:a.transitions.create(["background-color","box-shadow"]),cursor:"unset",outline:0,textDecoration:"none",border:0,padding:0,verticalAlign:"middle",boxSizing:"border-box",[`&.${o.disabled}`]:{opacity:(a.vars||a).palette.action.disabledOpacity,pointerEvents:"none"},[`& .${o.avatar}`]:{marginLeft:5,marginRight:-6,width:24,height:24,color:a.vars?a.vars.palette.Chip.defaultAvatarColor:p,fontSize:a.typography.pxToRem(12)},[`& .${o.avatarColorPrimary}`]:{color:(a.vars||a).palette.primary.contrastText,backgroundColor:(a.vars||a).palette.primary.dark},[`& .${o.avatarColorSecondary}`]:{color:(a.vars||a).palette.secondary.contrastText,backgroundColor:(a.vars||a).palette.secondary.dark},[`& .${o.avatarSmall}`]:{marginLeft:4,marginRight:-4,width:18,height:18,fontSize:a.typography.pxToRem(10)},[`& .${o.icon}`]:f({marginLeft:5,marginRight:-6},e.size==="small"&&{fontSize:18,marginLeft:4,marginRight:-4},e.iconColor===e.color&&f({color:a.vars?a.vars.palette.Chip.defaultIconColor:p},e.color!=="default"&&{color:"inherit"})),[`& .${o.deleteIcon}`]:f({WebkitTapHighlightColor:"transparent",color:a.vars?`rgba(${a.vars.palette.text.primaryChannel} / 0.26)`:C(a.palette.text.primary,.26),fontSize:22,cursor:"pointer",margin:"0 5px 0 -6px","&:hover":{color:a.vars?`rgba(${a.vars.palette.text.primaryChannel} / 0.4)`:C(a.palette.text.primary,.4)}},e.size==="small"&&{fontSize:16,marginRight:4,marginLeft:-4},e.color!=="default"&&{color:a.vars?`rgba(${a.vars.palette[e.color].contrastTextChannel} / 0.7)`:C(a.palette[e.color].contrastText,.7),"&:hover, &:active":{color:(a.vars||a).palette[e.color].contrastText}})},e.size==="small"&&{height:24},e.color!=="default"&&{backgroundColor:(a.vars||a).palette[e.color].main,color:(a.vars||a).palette[e.color].contrastText},e.onDelete&&{[`&.${o.focusVisible}`]:{backgroundColor:a.vars?`rgba(${a.vars.palette.action.selectedChannel} / calc(${a.vars.palette.action.selectedOpacity} + ${a.vars.palette.action.focusOpacity}))`:C(a.palette.action.selected,a.palette.action.selectedOpacity+a.palette.action.focusOpacity)}},e.onDelete&&e.color!=="default"&&{[`&.${o.focusVisible}`]:{backgroundColor:(a.vars||a).palette[e.color].dark}})},({theme:a,ownerState:e})=>f({},e.clickable&&{userSelect:"none",WebkitTapHighlightColor:"transparent",cursor:"pointer","&:hover":{backgroundColor:a.vars?`rgba(${a.vars.palette.action.selectedChannel} / calc(${a.vars.palette.action.selectedOpacity} + ${a.vars.palette.action.hoverOpacity}))`:C(a.palette.action.selected,a.palette.action.selectedOpacity+a.palette.action.hoverOpacity)},[`&.${o.focusVisible}`]:{backgroundColor:a.vars?`rgba(${a.vars.palette.action.selectedChannel} / calc(${a.vars.palette.action.selectedOpacity} + ${a.vars.palette.action.focusOpacity}))`:C(a.palette.action.selected,a.palette.action.selectedOpacity+a.palette.action.focusOpacity)},"&:active":{boxShadow:(a.vars||a).shadows[1]}},e.clickable&&e.color!=="default"&&{[`&:hover, &.${o.focusVisible}`]:{backgroundColor:(a.vars||a).palette[e.color].dark}}),({theme:a,ownerState:e})=>f({},e.variant==="outlined"&&{backgroundColor:"transparent",border:a.vars?`1px solid ${a.vars.palette.Chip.defaultBorder}`:`1px solid ${a.palette.mode==="light"?a.palette.grey[400]:a.palette.grey[700]}`,[`&.${o.clickable}:hover`]:{backgroundColor:(a.vars||a).palette.action.hover},[`&.${o.focusVisible}`]:{backgroundColor:(a.vars||a).palette.action.focus},[`& .${o.avatar}`]:{marginLeft:4},[`& .${o.avatarSmall}`]:{marginLeft:2},[`& .${o.icon}`]:{marginLeft:4},[`& .${o.iconSmall}`]:{marginLeft:2},[`& .${o.deleteIcon}`]:{marginRight:5},[`& .${o.deleteIconSmall}`]:{marginRight:3}},e.variant==="outlined"&&e.color!=="default"&&{color:(a.vars||a).palette[e.color].main,border:`1px solid ${a.vars?`rgba(${a.vars.palette[e.color].mainChannel} / 0.7)`:C(a.palette[e.color].main,.7)}`,[`&.${o.clickable}:hover`]:{backgroundColor:a.vars?`rgba(${a.vars.palette[e.color].mainChannel} / ${a.vars.palette.action.hoverOpacity})`:C(a.palette[e.color].main,a.palette.action.hoverOpacity)},[`&.${o.focusVisible}`]:{backgroundColor:a.vars?`rgba(${a.vars.palette[e.color].mainChannel} / ${a.vars.palette.action.focusOpacity})`:C(a.palette[e.color].main,a.palette.action.focusOpacity)},[`& .${o.deleteIcon}`]:{color:a.vars?`rgba(${a.vars.palette[e.color].mainChannel} / 0.7)`:C(a.palette[e.color].main,.7),"&:hover, &:active":{color:(a.vars||a).palette[e.color].main}}})),Ra=G("span",{name:"MuiChip",slot:"Label",overridesResolver:(a,e)=>{const{ownerState:p}=a,{size:c}=p;return[e.label,e[`label${i(c)}`]]}})(({ownerState:a})=>f({overflow:"hidden",textOverflow:"ellipsis",paddingLeft:12,paddingRight:12,whiteSpace:"nowrap"},a.variant==="outlined"&&{paddingLeft:11,paddingRight:11},a.size==="small"&&{paddingLeft:8,paddingRight:8},a.size==="small"&&a.variant==="outlined"&&{paddingLeft:7,paddingRight:7}));function q(a){return a.key==="Backspace"||a.key==="Delete"}const L=x.forwardRef(function(e,p){const c=ca({props:e,name:"MuiChip"}),{avatar:s,className:b,clickable:v,color:t="default",component:u,deleteIcon:$,disabled:r=!1,icon:g,label:I,onClick:E,onDelete:j,onKeyDown:F,onKeyUp:V,size:J="medium",variant:Q="filled",tabIndex:X,skipFocusWhenDisabled:Y=!1}=c,Z=sa(c,Da),m=x.useRef(null),w=na(m,p),M=d=>{d.stopPropagation(),j&&j(d)},aa=d=>{d.currentTarget===d.target&&q(d)&&d.preventDefault(),F&&F(d)},la=d=>{d.currentTarget===d.target&&(j&&q(d)?j(d):d.key==="Escape"&&m.current&&m.current.blur()),V&&V(d)},D=v!==!1&&E?!0:v,z=D||j?K:u||"div",O=f({},c,{component:z,disabled:r,size:J,color:t,iconColor:x.isValidElement(g)&&g.props.color||t,onDelete:!!j,clickable:D,variant:Q}),h=za(O),ea=z===K?f({component:u||"div",focusVisibleClassName:h.focusVisible},j&&{disableRipple:!0}):{};let S=null;j&&(S=$&&x.isValidElement($)?x.cloneElement($,{className:k($.props.className,h.deleteIcon),onClick:M}):l.jsx(Ia,{className:k(h.deleteIcon),onClick:M}));let U=null;s&&x.isValidElement(s)&&(U=x.cloneElement(s,{className:k(h.avatar,s.props.className)}));let W=null;return g&&x.isValidElement(g)&&(W=x.cloneElement(g,{className:k(h.icon,g.props.className)})),l.jsxs(Oa,f({as:z,className:k(h.root,b),disabled:D&&r?!0:void 0,onClick:E,onKeyDown:aa,onKeyUp:la,ref:w,tabIndex:Y&&r?-1:X,ownerState:O},ea,Z,{children:[U||W,l.jsx(Ra,{className:k(h.label),ownerState:O,children:I}),S]}))}),N="admin/orders";function Pa(){const{data:a,error:e,isLoading:p,mutate:c}=da(N,()=>B.get(N).then(b=>b.data));return{orders:a||[],isLoading:p,error:e,updateOrderStatus:async(b,v)=>{await B.put(`${N}/${b}/status`,{status:v}),await c()}}}function Ta(){const{orders:a,isLoading:e,updateOrderStatus:p}=Pa(),{enqueueSnackbar:c}=ja(),[s,b]=x.useState(null),[v,t]=x.useState(!1),u=async(r,g)=>{try{await p(r,g),c(g==="completed"?"Заказ успешно выполнен":"Заказ отменен",{variant:g==="completed"?"success":"warning"})}catch(I){console.error("Error updating status:",I),c("Ошибка при обновлении статуса",{variant:"error"})}},$=r=>{b(r),t(!0)};return console.log(a),e?l.jsx(H,{sx:{display:"flex",justifyContent:"center",p:3},children:l.jsx(pa,{})}):l.jsxs(ua,{sx:{width:"100%"},children:[l.jsxs(R,{spacing:3,children:[l.jsx(y,{variant:"h4",children:"Заказы клиентов"}),l.jsx(ba,{children:l.jsx(va,{component:xa,children:l.jsxs(ga,{children:[l.jsx(Ca,{children:l.jsxs(_,{children:[l.jsx(n,{children:"ID Заказа"}),l.jsx(n,{children:"Дата"}),l.jsx(n,{children:"Клиент"}),l.jsx(n,{children:"Литры"}),l.jsx(n,{children:"Цена"}),l.jsx(n,{children:"Сумма"}),l.jsx(n,{children:"Скидка"}),l.jsx(n,{children:"К оплате"}),l.jsx(n,{children:"Адрес"}),l.jsx(n,{children:"Контакты"}),l.jsx(n,{children:"Статус"}),l.jsx(n,{children:"Действия"})]})}),l.jsx(fa,{children:a.map(r=>l.jsxs(_,{children:[l.jsx(n,{children:r["ID Заказа"]}),l.jsx(n,{children:r.Дата}),l.jsx(n,{children:l.jsx(H,{sx:{cursor:"pointer","&:hover":{textDecoration:"underline"}},onClick:()=>r.user&&$(r.user),children:r.Клиент})}),l.jsx(n,{children:r.Литры}),l.jsx(n,{children:parseFloat(Number(r.Цена).toFixed(0))}),l.jsx(n,{children:parseFloat(Number(r.Сумма).toFixed(0))}),l.jsx(n,{children:l.jsx(L,{label:r.Скидка,color:r.Скидка?"success":"default",size:"small"})}),l.jsx(n,{children:parseFloat(Number(r["К оплате"]).toFixed(0))}),l.jsx(n,{children:r.Адрес}),l.jsxs(n,{children:[l.jsx("div",{children:r.Контакты.phone}),l.jsx("div",{children:r.Контакты.email})]}),l.jsx(n,{children:l.jsx("div",{children:r.Статус})}),l.jsx(n,{children:r.Статус==="completed"?l.jsx(L,{label:"Выполнен",color:"success",size:"small"}):r.Статус==="cancelled"?l.jsx(L,{label:"Отменен",color:"error",size:"small"}):l.jsxs(R,{direction:"row",spacing:1,children:[l.jsx(P,{onClick:()=>u(r["ID Заказа"],"completed"),color:"success",size:"small",title:"Выполнить",disabled:r.Статус==="Выполнен",children:l.jsx(T,{icon:"eva:checkmark-circle-2-fill"})}),l.jsx(P,{onClick:()=>u(r["ID Заказа"],"cancelled"),color:"error",size:"small",title:"Отменить",disabled:r.Статус==="Выполнен",children:l.jsx(T,{icon:"eva:close-circle-fill"})})]})})]},r["ID Заказа"]))})]})})})]}),l.jsxs(ya,{open:v,onClose:()=>t(!1),maxWidth:"sm",fullWidth:!0,children:[l.jsxs(ha,{children:["Информаци�� о клиенте",l.jsx(P,{onClick:()=>t(!1),sx:{position:"absolute",right:8,top:8},children:l.jsx(T,{icon:"eva:close-fill"})})]}),l.jsx(ka,{children:s&&l.jsx(A,{container:!0,spacing:2,sx:{pt:2},children:l.jsx(A,{item:!0,xs:12,children:l.jsxs(R,{spacing:2,children:[l.jsxs(y,{variant:"subtitle2",children:["ID: ",s.id]}),l.jsxs(y,{variant:"subtitle2",children:["Имя: ",s.name]}),l.jsxs(y,{variant:"subtitle2",children:["Телефон: ",s.phone]}),l.jsxs(y,{variant:"subtitle2",children:["Email: ",s.email]}),l.jsxs(y,{variant:"subtitle2",children:["Адрес: ",s.address]}),l.jsxs(y,{variant:"subtitle2",children:["Баланс: ",s.balance," руб."]}),l.jsxs(y,{variant:"subtitle2",children:["Накопленные скидки: ",s.discountBalance," руб."]})]})})})})]})]})}function Va(){return l.jsxs(l.Fragment,{children:[l.jsx($a,{children:l.jsx("title",{children:"Заказы"})}),l.jsx(Ta,{})]})}export{Va as default};
